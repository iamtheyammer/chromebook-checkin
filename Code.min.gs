/* CODE FROM https://github.com/iamtheyammer/chromebook-checkin. DO NOT DELETE THIS NOTICE. */ function onOpen(e){SpreadsheetApp.getUi().createMenu("Chromebook Check-In").addItem("Start","checkIn").addToUi()}function checkIn(){var e="abc.com",t="Sheet1",r=SpreadsheetApp.getUi(),n=r.prompt("Enter the student's email.","Omit the @"+e+".",r.ButtonSet.OK_CANCEL);if(n.getSelectedButton()!=r.Button.CANCEL&&n.getSelectedButton!=r.Button.CLOSE){n=n.getResponseText().split("@")[0],Logger.log(n);for(var o=SpreadsheetApp.getActiveSpreadsheet().getSheetByName(t).getRange("A1:A123").getValues(),a=0;a<o.length;a++){if(n+"@"+e==o[a-1])break;if(a==o.length-1)return r.alert("I couldn't find that email in my list. Try again.")}var i=SpreadsheetApp.getActiveSpreadsheet().getSheetByName(t).getRange("A"+a+":N"+a).getValues(),s=i[0][8],g=i[0][6];Logger.log("Serial: "+s),Logger.log("Row: "+i);var h=r.prompt("Verify:","Is "+s+" the serial number? Enter 'y,' if so or 'n' if not. Is the charger present? Enter 'y,' if so or 'n' if not. Now, if there are any problems with the device, enter them and press OK. (their homeroom is "+g+")",r.ButtonSet.OK).getResponseText();if(h.getSelectedButton()!=r.Button.CANCEL&&h.getSelectedButton!=r.Button.CLOSE){if(h=h.split(","),Logger.log(h),"n"==h[0])var l=!1;else l=!0;if("n"==h[1])var p="No";else p="Yes";if(h[2])if(0==l)var d="Serial does not match; "+h[3];else d=h[2];else if(0==l)d="Serial does not match;";else d=" ";SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Printed List").getRange("C"+a+":E"+a).setValues([["Yes",p,d]])}}}
